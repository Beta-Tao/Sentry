# Sentry
The control code for RM sentry.

## 功能模块

### 遥控器模式：

用于日常调试，正式比赛的时候尝试使用OLED上的按键进行模式切换以保证正常工作。

### 全自动模式：

此时云台和底盘直接受主控板控制，根据主控中的逻辑以及MiniPC中的数据进行云台及底盘的控制。

### 操作档位说明：

#### 遥控器模式：

|位置            |控制对象                 |
|----------------|-------------------------|
|ch2             |底盘左右移动             |
|ch1             |云台Pitch轴俯仰运动      |
|ch0             |云台Yaw轴左右运动        |
|拨杆左上        |底盘巡逻模式             |
|拨杆左中        |底盘遥控模式             |
|拨杆左下        |底盘急停                 |
|拨杆右上        |云台跟踪模式             |
|拨杆右中        |云台遥控模式             |
|拨杆右下        |云台调试模式             |

## 程序说明

### 简要说明

哨兵使用两块主控板。
位于上底盘的主控板（以下简称上板）用于控制底盘运动并接收遥控器及MiniPC数据。
位于下底盘的主控板（以下简称下板）用于控制云台运动并进行跟随

### 软件关键信息说明

#### 中断使用说明

- Sentry_Move:

|	中断类型	|	抢占优先级	|	子优先级	|周期	        	|内容								        |
|---------------|---------------|---------------|-------------------|-------------------------------------------|
|CAN1接收中断	|		2		|		2		|每个电机1ms		|获取底盘电机及供弹电机位置及转速并做控制	|
|遥控器接收中断	|		1		|		2		|		14ms	 	|获取遥控器值						        |
|USART1接收中断 |		1		|		2		|		 14ms		|根据遥控器返回数据更新底盘及云台状态		|
|USART6接收中断 |       1       |       1       |不定               |接收裁判系统返回数据                       |
|USART3接收中断 |		\		|		\		|大概在15ms左右		|小电脑接收中断								|

- Sentry_Aim:

|	中断类型	|	抢占优先级	|	子优先级	|周期	        	|内容								        |
|---------------|---------------|---------------|-------------------|-------------------------------------------|
|CAN1接收中断	|		2		|		2		|		 1ms		|获取云台电机位置及转速及摩擦轮转速并做控制 |
|USART6接收中断	|		1		|		2		|		 10ms		|获取AHRS信息，周期由芯片发送周期确定		|
|UART8接收中断  |       2       |       2       |        14ms       |获取上板传来的控制信息                     |

#### 硬件使用信息

- Sentry_Move：

1. CAN1：接收电机反馈并发送控制数据
2. USART1：接收遥控器信息
3. UART8：上下板通信串口
4. USART6：裁判系统接口
5. USART3: 小电脑通信接口

- Sentry_Aim：

1. CAN1：接收电机反馈并发送控制数据
2. USART6：获取AHRS信息
3. UART8：上下板通信串口
	


